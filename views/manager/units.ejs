<!-- Units Management -->
<div class="units-container">
    <!-- Units Filter Bar -->
    <div class="filter-bar">
        <div class="filter-group">
            <label>Status:</label>
            <select id="statusFilter" onchange="filterUnits()">
                <option value="all">All Units</option>
                <option value="available">Available</option>
                <option value="occupied">Occupied</option>
                <option value="maintenance">Under Maintenance</option>
            </select>
        </div>
        <div class="filter-group">
            <label>Building:</label>
            <select id="buildingFilter" onchange="filterUnits()">
                <option value="all">All Buildings</option>
                <option value="A">Building A</option>
                <option value="B">Building B</option>
                <option value="C">Building C</option>
            </select>
        </div>
        <div class="filter-group">
            <label>Bedrooms:</label>
            <select id="bedroomFilter" onchange="filterUnits()">
                <option value="all">Any</option>
                <option value="0">Studio</option>
                <option value="1">1 Bedroom</option>
                <option value="2">2 Bedrooms</option>
                <option value="3">3 Bedrooms</option>
                <option value="4">4+ Bedrooms</option>
            </select>
        </div>
        <div class="search-group">
            <input
                type="text"
                id="unitSearch"
                placeholder="Search unit number..."
                onkeyup="filterUnits()"
            />
            <i class="fas fa-search"></i>
        </div>
    </div>

    <!-- Units Grid/List Toggle -->
    <div class="view-toggle">
        <button class="toggle-btn active" onclick="setView('grid')">
            <i class="fas fa-th"></i> Grid View
        </button>
        <button class="toggle-btn" onclick="setView('list')">
            <i class="fas fa-list"></i> List View
        </button>
    </div>

    <!-- Units Display -->
    <div id="unitsDisplay" class="units-grid-view">
        <% if (units && units.length > 0) { %> <% units.forEach(unit => { %>
        <div
            class="unit-card-full status-<%= unit.status %>"
            data-unit-id="<%= unit._id %>"
            data-status="<%= unit.status %>"
            data-building="<%= unit.building %>"
            data-bedrooms="<%= unit.bedrooms %>"
            data-unit-number="<%= unit.unitNumber %>"
        >
            <div class="unit-card-header">
                <h3><%= unit.unitNumber %></h3>
                <span class="status-indicator <%= unit.status %>"
                    ><%= unit.status %></span
                >
            </div>

            <div class="unit-card-body">
                <div class="unit-info-grid">
                    <div class="info-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span
                            ><%= unit.streetAddress %>, <%= unit.city %>, <%=
                            unit.state %> <%= unit.zipCode %></span
                        >
                    </div>
                    <% if (unit.building) { %>
                        <div class="info-item">
                            <i class="fas fa-building"></i>
                            <span>Building <%= unit.building %></span>
                        </div>
                        <% } %>
                    <% if (unit.floor !== null && unit.floor !== undefined) { %>
                        <div class="info-item">
                            <i class="fas fa-stairs"></i>
                            <span>Floor <%= unit.floor %></span>
                        </div>
                    <% } %>
                    <div class="info-item">
                        <i class="fas fa-bed"></i>
                        <span><%= unit.bedrooms %> Bed</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-bath"></i>
                        <span><%= unit.bathrooms %> Bath</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-ruler"></i>
                        <span><%= unit.squareFeet %> sq ft</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-dollar-sign"></i>
                        <span>$<%= unit.monthlyRent %>/mo</span>
                    </div>
                </div>

                <% if (unit.currentTenant) { %>
                <div class="tenant-info">
                    <strong>Current Tenant:</strong>
                    <p>
                        <%= unit.currentTenant.firstName %> <%=
                        unit.currentTenant.lastName %>
                    </p>
                    <p class="tenant-contact">
                        <%= unit.currentTenant.email %>
                    </p>
                </div>
                <% } %> <% if (unit.amenities && unit.amenities.length > 0) { %>
                <div class="amenities">
                    <% unit.amenities.forEach(amenity => { %>
                    <span class="amenity-tag"><%= amenity %></span>
                    <% }) %>
                </div>
                <% } %>
            </div>

            <div class="unit-card-footer">
                <button
                    class="btn-icon"
                    onclick="editUnitPage('<%= unit._id %>')"
                    title="Edit"
                >
                    <i class="fas fa-edit"></i>
                </button>
                <button
                    class="btn-icon"
                    onclick="viewUnit('<%= unit._id %>')"
                    title="View Details"
                >
                    <i class="fas fa-eye"></i>
                </button>
                <% if (unit.status === 'available') { %>
                    <button
                        class="btn btn-primary btn-small"
                        onclick="openCreateLeaseModal(null, '<%= unit._id %>')"
                    >
                        Create Lease
                    </button>
                <% } else if (unit.currentTenant && unit.currentTenant._id) { %>
                    <button
                        class="btn btn-secondary btn-small"
                        onclick="viewTenant('<%= unit.currentTenant._id %>')"
                    >
                        View Tenant
                    </button>
                <% } %>
                <button
                    class="btn-icon danger"
                    onclick="deleteUnit('<%= unit._id %>')"
                    title="Delete"
                >
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
        <% }) %> <% } else { %>
        <div class="empty-state">
            <i class="fas fa-home-empty"></i>
            <h3>No Units Found</h3>
            <p>Start by adding your first unit</p>
            <button class="btn btn-primary" onclick="openAddUnitModal()">
                Add First Unit
            </button>
        </div>
        <% } %>
    </div>
</div>
